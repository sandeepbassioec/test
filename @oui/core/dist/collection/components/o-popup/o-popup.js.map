{"version":3,"file":"o-popup.js","sourceRoot":"","sources":["../../../src/components/o-popup/o-popup.tsx"],"names":[],"mappings":"AAAA,OAAO,EAAE,SAAS,EAAE,OAAO,EAAE,IAAI,EAAE,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,CAAC,EAAE,MAAM,eAAe,CAAC;AACjF,OAAO,EAAE,KAAK,EAAE,UAAU,EAAE,eAAe,EAAE,MAAM,EAAE,IAAI,EAAE,IAAI,EAAE,QAAQ,EAAE,MAAM,kBAAkB,CAAC;AACpG,OAAO,EAAE,YAAY,EAAE,MAAM,0BAA0B,CAAC;AAOxD,MAAM,OAAO,MAAM;IALnB;QAeC,8DAA8D;QACrC,WAAM,GAAY,KAAK,CAAC;QAEjD,mDAAmD;QAC1B,cAAS,GAYlB,KAAK,CAAC;QAEtB,sEAAsE;QAC7C,aAAQ,GAAyB,UAAU,CAAC;QAErE,oFAAoF;QAC5E,aAAQ,GAAW,CAAC,CAAC;QAK7B,mFAAmF;QAC3E,SAAI,GAAY,KAAK,CAAC;QAE9B,wEAAwE;QAChE,UAAK,GAAY,KAAK,CAAC;QAE/B,2GAA2G;QACnG,gBAAW,GAAY,KAAK,CAAC;QA4JrC,0BAA0B;QAC1B,sBAAiB,GAAG,GAAG,EAAE;YACxB,IAAI,IAAI,CAAC,WAAW,IAAI,IAAI,CAAC,QAAQ,EAAE,CAAC;gBACvC,MAAM,UAAU,GAAG,IAAI,CAAC,QAAQ,CAAC,qBAAqB,EAAE,CAAC;gBACzD,MAAM,SAAS,GAAG,IAAI,CAAC,KAAK,CAAC,qBAAqB,EAAE,CAAC;gBACrD,MAAM,UAAU,GAAG,IAAI,CAAC,SAAS,CAAC,QAAQ,CAAC,KAAK,CAAC,IAAI,IAAI,CAAC,SAAS,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC;gBACvF,IAAI,QAAQ,GAAG,CAAC,CAAC;gBACjB,IAAI,QAAQ,GAAG,CAAC,CAAC;gBACjB,IAAI,SAAS,GAAG,CAAC,CAAC;gBAClB,IAAI,SAAS,GAAG,CAAC,CAAC;gBAClB,IAAI,WAAW,GAAG,CAAC,CAAC;gBACpB,IAAI,WAAW,GAAG,CAAC,CAAC;gBACpB,IAAI,YAAY,GAAG,CAAC,CAAC;gBACrB,IAAI,YAAY,GAAG,CAAC,CAAC;gBAErB,IAAI,UAAU,EAAE,CAAC;oBAChB,IAAI,UAAU,CAAC,GAAG,GAAG,SAAS,CAAC,GAAG,EAAE,CAAC;wBACpC,kBAAkB;wBAClB,QAAQ,GAAG,UAAU,CAAC,IAAI,CAAC;wBAC3B,QAAQ,GAAG,UAAU,CAAC,MAAM,CAAC;wBAC7B,SAAS,GAAG,UAAU,CAAC,KAAK,CAAC;wBAC7B,SAAS,GAAG,UAAU,CAAC,MAAM,CAAC;wBAE9B,WAAW,GAAG,SAAS,CAAC,IAAI,CAAC;wBAC7B,WAAW,GAAG,SAAS,CAAC,GAAG,CAAC;wBAC5B,YAAY,GAAG,SAAS,CAAC,KAAK,CAAC;wBAC/B,YAAY,GAAG,SAAS,CAAC,GAAG,CAAC;oBAC9B,CAAC;yBAAM,CAAC;wBACP,kBAAkB;wBAClB,QAAQ,GAAG,SAAS,CAAC,IAAI,CAAC;wBAC1B,QAAQ,GAAG,SAAS,CAAC,MAAM,CAAC;wBAC5B,SAAS,GAAG,SAAS,CAAC,KAAK,CAAC;wBAC5B,SAAS,GAAG,SAAS,CAAC,MAAM,CAAC;wBAE7B,WAAW,GAAG,UAAU,CAAC,IAAI,CAAC;wBAC9B,WAAW,GAAG,UAAU,CAAC,GAAG,CAAC;wBAC7B,YAAY,GAAG,UAAU,CAAC,KAAK,CAAC;wBAChC,YAAY,GAAG,UAAU,CAAC,GAAG,CAAC;oBAC/B,CAAC;gBACF,CAAC;qBAAM,CAAC;oBACP,IAAI,UAAU,CAAC,IAAI,GAAG,SAAS,CAAC,IAAI,EAAE,CAAC;wBACtC,wBAAwB;wBACxB,QAAQ,GAAG,UAAU,CAAC,KAAK,CAAC;wBAC5B,QAAQ,GAAG,UAAU,CAAC,GAAG,CAAC;wBAC1B,SAAS,GAAG,SAAS,CAAC,IAAI,CAAC;wBAC3B,SAAS,GAAG,SAAS,CAAC,GAAG,CAAC;wBAE1B,WAAW,GAAG,UAAU,CAAC,KAAK,CAAC;wBAC/B,WAAW,GAAG,UAAU,CAAC,MAAM,CAAC;wBAChC,YAAY,GAAG,SAAS,CAAC,IAAI,CAAC;wBAC9B,YAAY,GAAG,SAAS,CAAC,MAAM,CAAC;oBACjC,CAAC;yBAAM,CAAC;wBACP,yBAAyB;wBACzB,QAAQ,GAAG,SAAS,CAAC,KAAK,CAAC;wBAC3B,QAAQ,GAAG,SAAS,CAAC,GAAG,CAAC;wBACzB,SAAS,GAAG,UAAU,CAAC,IAAI,CAAC;wBAC5B,SAAS,GAAG,UAAU,CAAC,GAAG,CAAC;wBAE3B,WAAW,GAAG,SAAS,CAAC,KAAK,CAAC;wBAC9B,WAAW,GAAG,SAAS,CAAC,MAAM,CAAC;wBAC/B,YAAY,GAAG,UAAU,CAAC,IAAI,CAAC;wBAC/B,YAAY,GAAG,UAAU,CAAC,MAAM,CAAC;oBAClC,CAAC;gBACF,CAAC;gBAED,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,WAAW,CAAC,2BAA2B,EAAE,GAAG,QAAQ,IAAI,CAAC,CAAC;gBACnF,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,WAAW,CAAC,2BAA2B,EAAE,GAAG,QAAQ,IAAI,CAAC,CAAC;gBACnF,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,WAAW,CAAC,4BAA4B,EAAE,GAAG,SAAS,IAAI,CAAC,CAAC;gBACrF,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,WAAW,CAAC,4BAA4B,EAAE,GAAG,SAAS,IAAI,CAAC,CAAC;gBACrF,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,WAAW,CAAC,8BAA8B,EAAE,GAAG,WAAW,IAAI,CAAC,CAAC;gBACzF,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,WAAW,CAAC,8BAA8B,EAAE,GAAG,WAAW,IAAI,CAAC,CAAC;gBACzF,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,WAAW,CAAC,+BAA+B,EAAE,GAAG,YAAY,IAAI,CAAC,CAAC;gBAC3F,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,WAAW,CAAC,+BAA+B,EAAE,GAAG,YAAY,IAAI,CAAC,CAAC;YAC5F,CAAC;QACF,CAAC,CAAC;KA8BF;IAjQA,WAAW;QACV,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC;IACvB,CAAC;IAED,iBAAiB;QAChB,IAAI,CAAC,KAAK,EAAE,CAAC;IACd,CAAC;IAED,KAAK,CAAC,oBAAoB;QACzB,MAAM,IAAI,CAAC,IAAI,EAAE,CAAC;IACnB,CAAC;IAED,0BAA0B;IAC1B,KAAK;QACJ,IAAI,OAAO,IAAI,KAAK,WAAW,EAAE,CAAC;YACjC,IAAI,CAAC,IAAI,CAAC,QAAQ,IAAI,CAAC,IAAI,CAAC,MAAM,EAAE,CAAC;gBACpC,OAAO;YACR,CAAC;YAED,IAAI,CAAC,OAAO,GAAG,UAAU,CAAC,IAAI,CAAC,QAAQ,EAAE,IAAI,CAAC,KAAK,EAAE,KAAK,IAAI,EAAE;gBAC/D,MAAM,IAAI,CAAC,UAAU,EAAE,CAAC;YACzB,CAAC,CAAC,CAAC;QACJ,CAAC;IACF,CAAC;IAEO,KAAK,CAAC,IAAI;QACjB,OAAO,IAAI,OAAO,CAAC,CAAC,OAAO,EAAE,EAAE;YAC9B,IAAI,IAAI,CAAC,OAAO,EAAE,CAAC;gBAClB,IAAI,CAAC,OAAO,EAAE,CAAC;gBACf,IAAI,CAAC,OAAO,GAAG,SAAS,CAAC;gBACzB,qBAAqB,CAAC,GAAG,EAAE,CAAC,OAAO,EAAE,CAAC,CAAC;YACxC,CAAC;iBAAM,CAAC;gBACP,OAAO,EAAE,CAAC;YACX,CAAC;QACF,CAAC,CAAC,CAAC;IACJ,CAAC;IAEO,KAAK,CAAC,kBAAkB;;QAC/B,MAAM,IAAI,CAAC,IAAI,EAAE,CAAC;QAElB,IAAI,CAAC,QAAQ,GAAG,MAAA,IAAI,CAAC,IAAI,0CAAE,aAAa,CAAc,iBAAiB,CAAC,CAAC;QAEzE,8GAA8G;QAC9G,0BAA0B;QAC1B,IAAI,OAAO,IAAI,KAAK,WAAW,EAAE,CAAC;YACjC,IAAI,IAAI,CAAC,QAAQ,YAAY,eAAe,EAAE,CAAC;gBAC9C,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC,QAAQ,CAAC,gBAAgB,CAAC,EAAE,OAAO,EAAE,IAAI,EAAE,CAAC,CAAC,CAAC,CAAgB,CAAC;YACrF,CAAC;QACF,CAAC;QAED,IAAI,IAAI,CAAC,QAAQ,IAAI,IAAI,CAAC,MAAM,EAAE,CAAC;YAClC,IAAI,CAAC,KAAK,EAAE,CAAC;QACd,CAAC;IACF,CAAC;IAED,0BAA0B;IAClB,KAAK,CAAC,MAAM,CAAC,QAAQ;QAC5B,IAAI,OAAO,IAAI,KAAK,WAAW,EAAE,CAAC;YACjC,IAAI,QAAQ,KAAK,QAAQ,EAAE,CAAC;gBAC3B,IAAI,IAAI,CAAC,MAAM,EAAE,CAAC;oBACjB,IAAI,CAAC,KAAK,EAAE,CAAC;gBACd,CAAC;qBAAM,CAAC;oBACP,MAAM,IAAI,CAAC,IAAI,EAAE,CAAC;gBACnB,CAAC;YACF,CAAC;YAED,IAAI,IAAI,CAAC,MAAM,EAAE,CAAC;gBACjB,MAAM,IAAI,CAAC,UAAU,EAAE,CAAC;YACzB,CAAC;QACF,CAAC;IACF,CAAC;IAED,0BAA0B;IAC1B,UAAU,CAAC,KAAK;QACf,MAAM,GAAG,GAAG,MAAM,CAAC,gBAAgB,IAAI,CAAC,CAAC;QACzC,OAAO,IAAI,CAAC,KAAK,CAAC,KAAK,GAAG,GAAG,CAAC,GAAG,GAAG,CAAC;IACtC,CAAC;IAED,0BAA0B;IAE1B,KAAK,CAAC,UAAU;QACf,MAAM,UAAU,GAAG,CAAC,MAAM,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAC;QAC3C,gDAAgD;QAChD,MAAM,aAAa,GAAG,EAAE,CAAC;QACzB,mEAAmE;QACnE,MAAM,cAAc,GAAG,EAAE,CAAC;QAE1B,IAAI,IAAI,CAAC,IAAI,EAAE,CAAC;YACf,UAAU,CAAC,IAAI,CACd,IAAI,CAAC;gBACJ,KAAK,EAAE,CAAC,EAAE,KAAK,EAAE,EAAE,EAAE;oBACpB,MAAM,SAAS,GAAG,IAAI,CAAC,IAAI,KAAK,OAAO,IAAI,IAAI,CAAC,IAAI,KAAK,MAAM,CAAC;oBAChE,MAAM,UAAU,GAAG,IAAI,CAAC,IAAI,KAAK,QAAQ,IAAI,IAAI,CAAC,IAAI,KAAK,MAAM,CAAC;oBAClE,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC,KAAK,GAAG,SAAS,CAAC,CAAC,CAAC,GAAG,KAAK,CAAC,SAAS,CAAC,KAAK,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC;oBACvE,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC,MAAM,GAAG,UAAU,CAAC,CAAC,CAAC,GAAG,KAAK,CAAC,SAAS,CAAC,MAAM,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC;gBAC3E,CAAC;aACD,CAAC,CACF,CAAC;QACH,CAAC;aAAM,CAAC;YACP,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC,KAAK,GAAG,EAAE,CAAC;YAC5B,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC,MAAM,GAAG,EAAE,CAAC;QAC9B,CAAC;QAED,IAAI,IAAI,CAAC,IAAI,EAAE,CAAC;YACf,UAAU,CAAC,IAAI,CAAC,IAAI,EAAE,CAAC,CAAC;QACzB,CAAC;QAED,IAAI,IAAI,CAAC,KAAK,EAAE,CAAC;YAChB,UAAU,CAAC,IAAI,CACd,KAAK,CAAC;gBACL,OAAO,EAAE,IAAI,CAAC,OAAO;gBACrB,OAAO,EAAE,aAAa;aACtB,CAAC,CACF,CAAC;QACH,CAAC;QAED,MAAM,eAAe,GACpB,IAAI,CAAC,QAAQ,KAAK,UAAU;YAC3B,CAAC,CAAC,CAAC,OAAgB,EAAE,EAAE,CAAC,QAAQ,CAAC,eAAe,CAAC,OAAO,EAAE,YAAY,CAAC;YACvE,CAAC,CAAC,QAAQ,CAAC,eAAe,CAAC;QAE7B,eAAe,CAAC,IAAI,CAAC,QAAQ,EAAE,IAAI,CAAC,KAAK,EAAE;YAC1C,SAAS,EAAE,IAAI,CAAC,SAAS;YACzB,UAAU;YACV,QAAQ,EAAE,IAAI,CAAC,QAAQ;YACvB,QAAQ,kCACJ,QAAQ,KACX,eAAe,GACf;SACD,CAAC,CAAC,IAAI,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,cAAc,EAAE,SAAS,EAAE,EAAE,EAAE;YAC/C,MAAM,CAAC,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC,KAAK,EAAE;gBAC/B,IAAI,EAAE,GAAG;gBACT,GAAG,EAAE,GAAG;gBACR,SAAS,EAAE,aAAa,IAAI,CAAC,UAAU,CAAC,CAAC,CAAC,MAAM,IAAI,CAAC,UAAU,CAAC,CAAC,CAAC,KAAK;aACvE,CAAC,CAAC;YAEH,IAAI,IAAI,CAAC,KAAK,EAAE,CAAC;gBAChB,MAAM,UAAU,GAAG,EAAE,GAAG,EAAE,QAAQ,EAAE,KAAK,EAAE,MAAM,EAAE,MAAM,EAAE,KAAK,EAAE,IAAI,EAAE,OAAO,EAAE,CAAC,SAAS,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAE,CAAC;gBAE5G,MAAM,MAAM,GAAG,cAAc,CAAC,KAAK,CAAC,CAAC,CAAC;gBACtC,MAAM,MAAM,GAAG,cAAc,CAAC,KAAK,CAAC,CAAC,CAAC;gBAEtC,MAAM,CAAC,MAAM,CAAC,IAAI,CAAC,OAAO,CAAC,KAAK,EAAE;oBACjC,IAAI,EAAE,MAAM,IAAI,IAAI,CAAC,CAAC,CAAC,GAAG,MAAM,IAAI,CAAC,CAAC,CAAC,EAAE;oBACzC,GAAG,EAAE,MAAM,IAAI,IAAI,CAAC,CAAC,CAAC,GAAG,MAAM,IAAI,CAAC,CAAC,CAAC,EAAE;oBACxC,CAAC,UAAU,CAAC,EAAE,GAAG,CAAC,cAAc,GAAG,CAAC,IAAI;iBACxC,CAAC,CAAC;YACJ,CAAC;QACF,CAAC,CAAC,CAAC;QAEH,qBAAqB,CAAC,GAAG,EAAE,CAAC,IAAI,CAAC,iBAAiB,EAAE,CAAC,CAAC;IACvD,CAAC;IA8ED,MAAM;QACL,MAAM,YAAY,GAAG,IAAI,CAAC,MAAM,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,QAAQ,CAAC;QACjD,OAAO,CACN,EAAC,IAAI;YACJ,6DAAM,IAAI,EAAC,QAAQ,EAAC,YAAY,EAAE,GAAG,EAAE,CAAC,IAAI,CAAC,kBAAkB,EAAE,GAAS;YAI1E,6DACC,GAAG,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC,CAAC,IAAI,CAAC,aAAa,GAAG,EAAE,CAAC,EACtC,KAAK,EAAE,8BAA8B,CAAC,CAAC,IAAI,CAAC,WAAW,IAAI,IAAI,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,QAAQ,CAAC,CAAC,CAAC,EAAE,EAAE,GAClF;YAER,4DAAK,GAAG,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC,CAAC,IAAI,CAAC,KAAK,GAAG,EAAE,CAAC,EAAE,KAAK,EAAE,6BAA6B,IAAI,CAAC,QAAQ,IAAI,YAAY,EAAE;gBACvG,8DAAa;gBACZ,IAAI,CAAC,KAAK,IAAI,CACd,4DACC,GAAG,EAAE,CAAC,EAAE,EAAE,EAAE;wBACX,IAAI,CAAC,OAAO,GAAG,EAAE,CAAC;oBACnB,CAAC,EACD,KAAK,EAAE,mDAAmD,YAAY,EAAE,EACxE,IAAI,EAAC,cAAc,GACb,CACP,CACI,CACA,CACP,CAAC;IACH,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;CACD","sourcesContent":["import { Component, Element, Host, Method, Prop, Watch, h } from '@stencil/core';\r\nimport { arrow, autoUpdate, computePosition, offset, size, flip, platform } from '@floating-ui/dom';\r\nimport { offsetParent } from 'composed-offset-position';\r\n\r\n@Component({\r\n\ttag: 'o-popup',\r\n\tstyleUrl: 'o-popup.scss',\r\n\tshadow: true\r\n})\r\nexport class OPopup {\r\n\tprivate anchorEl: Element | null;\r\n\tpopup: HTMLElement | null;\r\n\tprivate arrowEl: HTMLElement | null;\r\n\tprivate hoverBridgeEl: HTMLElement | null;\r\n\tprivate cleanup: ReturnType<typeof autoUpdate> | undefined;\r\n\r\n\t/** Reference to the host element */\r\n\t@Element() host: HTMLElement;\r\n\r\n\t/** The open state of the popup, defaults to closed (false) */\r\n\t@Prop({ reflect: true }) active: boolean = false;\r\n\r\n\t/** Position of the popup relative to the anchor */\r\n\t@Prop({ reflect: true }) placement:\r\n\t\t| 'top'\r\n\t\t| 'top-start'\r\n\t\t| 'top-end'\r\n\t\t| 'bottom'\r\n\t\t| 'bottom-start'\r\n\t\t| 'bottom-end'\r\n\t\t| 'right'\r\n\t\t| 'right-start'\r\n\t\t| 'right-end'\r\n\t\t| 'left'\r\n\t\t| 'left-start'\r\n\t\t| 'left-end' = 'top';\r\n\r\n\t/** Sets whether popup uses fixed positioning, defaults to absolute */\r\n\t@Prop({ reflect: true }) strategy: 'absolute' | 'fixed' = 'absolute';\r\n\r\n\t/** Determines amount of space between anchor and popup content, defaults to zero */\r\n\t@Prop() distance: number = 0;\r\n\r\n\t/** Syncs sizing of popup content to anchor sizing */\r\n\t@Prop() sync: 'width' | 'height' | 'both';\r\n\r\n\t/** Allows popup to change position on axis to remain in view, defaults to false */\r\n\t@Prop() flip: boolean = false;\r\n\r\n\t/** Sets whether an arrow displays along the bottom edge of the popup */\r\n\t@Prop() arrow: boolean = false;\r\n\r\n\t/** Allows for creation of element between popup and anchor when popup is active to maintain hover state */\r\n\t@Prop() hoverBridge: boolean = false;\r\n\r\n\t@Watch('active')\r\n\twatchActive() {\r\n\t\tthis.update('active');\r\n\t}\r\n\r\n\tconnectedCallback() {\r\n\t\tthis.start();\r\n\t}\r\n\r\n\tasync disconnectedCallback() {\r\n\t\tawait this.stop();\r\n\t}\r\n\r\n\t/* istanbul ignore next */\r\n\tstart() {\r\n\t\tif (typeof jest === 'undefined') {\r\n\t\t\tif (!this.anchorEl || !this.active) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tthis.cleanup = autoUpdate(this.anchorEl, this.popup, async () => {\r\n\t\t\t\tawait this.reposition();\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tprivate async stop(): Promise<void> {\r\n\t\treturn new Promise((resolve) => {\r\n\t\t\tif (this.cleanup) {\r\n\t\t\t\tthis.cleanup();\r\n\t\t\t\tthis.cleanup = undefined;\r\n\t\t\t\trequestAnimationFrame(() => resolve());\r\n\t\t\t} else {\r\n\t\t\t\tresolve();\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tprivate async handleAnchorChange() {\r\n\t\tawait this.stop();\r\n\r\n\t\tthis.anchorEl = this.host?.querySelector<HTMLElement>('[slot=\"anchor\"]');\r\n\r\n\t\t// if anchor is <slot>, dig a layer deeper to set the anchor appropriately (used in the case of nested popups)\r\n\t\t/* istanbul ignore next */\r\n\t\tif (typeof jest === 'undefined') {\r\n\t\t\tif (this.anchorEl instanceof HTMLSlotElement) {\r\n\t\t\t\tthis.anchorEl = this.anchorEl.assignedElements({ flatten: true })[0] as HTMLElement;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (this.anchorEl && this.active) {\r\n\t\t\tthis.start();\r\n\t\t}\r\n\t}\r\n\r\n\t/* istanbul ignore next */\r\n\tprivate async update(property) {\r\n\t\tif (typeof jest === 'undefined') {\r\n\t\t\tif (property === 'active') {\r\n\t\t\t\tif (this.active) {\r\n\t\t\t\t\tthis.start();\r\n\t\t\t\t} else {\r\n\t\t\t\t\tawait this.stop();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (this.active) {\r\n\t\t\t\tawait this.reposition();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t/* istanbul ignore next */\r\n\troundByDPR(value) {\r\n\t\tconst dpr = window.devicePixelRatio || 1;\r\n\t\treturn Math.round(value * dpr) / dpr;\r\n\t}\r\n\r\n\t/* istanbul ignore next */\r\n\t@Method()\r\n\tasync reposition() {\r\n\t\tconst middleware = [offset(this.distance)];\r\n\t\t// padding from side of popup container to arrow\r\n\t\tconst ARROW_PADDING = 10;\r\n\t\t// width and height of initial arrow box, before rotation and shift\r\n\t\tconst ARROW_BOX_SIZE = 10;\r\n\r\n\t\tif (this.sync) {\r\n\t\t\tmiddleware.push(\r\n\t\t\t\tsize({\r\n\t\t\t\t\tapply: ({ rects }) => {\r\n\t\t\t\t\t\tconst syncWidth = this.sync === 'width' || this.sync === 'both';\r\n\t\t\t\t\t\tconst syncHeight = this.sync === 'height' || this.sync === 'both';\r\n\t\t\t\t\t\tthis.popup.style.width = syncWidth ? `${rects.reference.width}px` : '';\r\n\t\t\t\t\t\tthis.popup.style.height = syncHeight ? `${rects.reference.height}px` : '';\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t);\r\n\t\t} else {\r\n\t\t\tthis.popup.style.width = '';\r\n\t\t\tthis.popup.style.height = '';\r\n\t\t}\r\n\r\n\t\tif (this.flip) {\r\n\t\t\tmiddleware.push(flip());\r\n\t\t}\r\n\r\n\t\tif (this.arrow) {\r\n\t\t\tmiddleware.push(\r\n\t\t\t\tarrow({\r\n\t\t\t\t\telement: this.arrowEl,\r\n\t\t\t\t\tpadding: ARROW_PADDING\r\n\t\t\t\t})\r\n\t\t\t);\r\n\t\t}\r\n\r\n\t\tconst getOffsetParent =\r\n\t\t\tthis.strategy === 'absolute'\r\n\t\t\t\t? (element: Element) => platform.getOffsetParent(element, offsetParent)\r\n\t\t\t\t: platform.getOffsetParent;\r\n\r\n\t\tcomputePosition(this.anchorEl, this.popup, {\r\n\t\t\tplacement: this.placement,\r\n\t\t\tmiddleware,\r\n\t\t\tstrategy: this.strategy,\r\n\t\t\tplatform: {\r\n\t\t\t\t...platform,\r\n\t\t\t\tgetOffsetParent\r\n\t\t\t}\r\n\t\t}).then(({ x, y, middlewareData, placement }) => {\r\n\t\t\tObject.assign(this.popup.style, {\r\n\t\t\t\tleft: '0',\r\n\t\t\t\ttop: '0',\r\n\t\t\t\ttransform: `translate(${this.roundByDPR(x)}px,${this.roundByDPR(y)}px)`\r\n\t\t\t});\r\n\r\n\t\t\tif (this.arrow) {\r\n\t\t\t\tconst staticSide = { top: 'bottom', right: 'left', bottom: 'top', left: 'right' }[placement.split('-')[0]]!;\r\n\r\n\t\t\t\tconst arrowX = middlewareData.arrow.x;\r\n\t\t\t\tconst arrowY = middlewareData.arrow.y;\r\n\r\n\t\t\t\tObject.assign(this.arrowEl.style, {\r\n\t\t\t\t\tleft: arrowX != null ? `${arrowX}px` : '',\r\n\t\t\t\t\ttop: arrowY != null ? `${arrowY}px` : '',\r\n\t\t\t\t\t[staticSide]: `${-ARROW_BOX_SIZE / 2}px`\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\trequestAnimationFrame(() => this.updateHoverBridge());\r\n\t}\r\n\r\n\t/* istanbul ignore next */\r\n\tupdateHoverBridge = () => {\r\n\t\tif (this.hoverBridge && this.anchorEl) {\r\n\t\t\tconst anchorRect = this.anchorEl.getBoundingClientRect();\r\n\t\t\tconst popupRect = this.popup.getBoundingClientRect();\r\n\t\t\tconst isVertical = this.placement.includes('top') || this.placement.includes('bottom');\r\n\t\t\tlet topLeftX = 0;\r\n\t\t\tlet topLeftY = 0;\r\n\t\t\tlet topRightX = 0;\r\n\t\t\tlet topRightY = 0;\r\n\t\t\tlet bottomLeftX = 0;\r\n\t\t\tlet bottomLeftY = 0;\r\n\t\t\tlet bottomRightX = 0;\r\n\t\t\tlet bottomRightY = 0;\r\n\r\n\t\t\tif (isVertical) {\r\n\t\t\t\tif (anchorRect.top < popupRect.top) {\r\n\t\t\t\t\t// Anchor is above\r\n\t\t\t\t\ttopLeftX = anchorRect.left;\r\n\t\t\t\t\ttopLeftY = anchorRect.bottom;\r\n\t\t\t\t\ttopRightX = anchorRect.right;\r\n\t\t\t\t\ttopRightY = anchorRect.bottom;\r\n\r\n\t\t\t\t\tbottomLeftX = popupRect.left;\r\n\t\t\t\t\tbottomLeftY = popupRect.top;\r\n\t\t\t\t\tbottomRightX = popupRect.right;\r\n\t\t\t\t\tbottomRightY = popupRect.top;\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// Anchor is below\r\n\t\t\t\t\ttopLeftX = popupRect.left;\r\n\t\t\t\t\ttopLeftY = popupRect.bottom;\r\n\t\t\t\t\ttopRightX = popupRect.right;\r\n\t\t\t\t\ttopRightY = popupRect.bottom;\r\n\r\n\t\t\t\t\tbottomLeftX = anchorRect.left;\r\n\t\t\t\t\tbottomLeftY = anchorRect.top;\r\n\t\t\t\t\tbottomRightX = anchorRect.right;\r\n\t\t\t\t\tbottomRightY = anchorRect.top;\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tif (anchorRect.left < popupRect.left) {\r\n\t\t\t\t\t// Anchor is on the left\r\n\t\t\t\t\ttopLeftX = anchorRect.right;\r\n\t\t\t\t\ttopLeftY = anchorRect.top;\r\n\t\t\t\t\ttopRightX = popupRect.left;\r\n\t\t\t\t\ttopRightY = popupRect.top;\r\n\r\n\t\t\t\t\tbottomLeftX = anchorRect.right;\r\n\t\t\t\t\tbottomLeftY = anchorRect.bottom;\r\n\t\t\t\t\tbottomRightX = popupRect.left;\r\n\t\t\t\t\tbottomRightY = popupRect.bottom;\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// Anchor is on the right\r\n\t\t\t\t\ttopLeftX = popupRect.right;\r\n\t\t\t\t\ttopLeftY = popupRect.top;\r\n\t\t\t\t\ttopRightX = anchorRect.left;\r\n\t\t\t\t\ttopRightY = anchorRect.top;\r\n\r\n\t\t\t\t\tbottomLeftX = popupRect.right;\r\n\t\t\t\t\tbottomLeftY = popupRect.bottom;\r\n\t\t\t\t\tbottomRightX = anchorRect.left;\r\n\t\t\t\t\tbottomRightY = anchorRect.bottom;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tthis.hoverBridgeEl.style.setProperty('--hover-bridge-top-left-x', `${topLeftX}px`);\r\n\t\t\tthis.hoverBridgeEl.style.setProperty('--hover-bridge-top-left-y', `${topLeftY}px`);\r\n\t\t\tthis.hoverBridgeEl.style.setProperty('--hover-bridge-top-right-x', `${topRightX}px`);\r\n\t\t\tthis.hoverBridgeEl.style.setProperty('--hover-bridge-top-right-y', `${topRightY}px`);\r\n\t\t\tthis.hoverBridgeEl.style.setProperty('--hover-bridge-bottom-left-x', `${bottomLeftX}px`);\r\n\t\t\tthis.hoverBridgeEl.style.setProperty('--hover-bridge-bottom-left-y', `${bottomLeftY}px`);\r\n\t\t\tthis.hoverBridgeEl.style.setProperty('--hover-bridge-bottom-right-x', `${bottomRightX}px`);\r\n\t\t\tthis.hoverBridgeEl.style.setProperty('--hover-bridge-bottom-right-y', `${bottomRightY}px`);\r\n\t\t}\r\n\t};\r\n\r\n\trender() {\r\n\t\tconst displayClass = this.active ? '' : 'hidden';\r\n\t\treturn (\r\n\t\t\t<Host>\r\n\t\t\t\t<slot name=\"anchor\" onSlotchange={() => this.handleAnchorChange()}></slot>\r\n\t\t\t\t{/* eslint-disable tailwindcss/no-custom-classname --\r\n\t\t\t\t * The hover-bridge class is used so that when a trigger is clicked (e.g., a tooltip), a zone is created around the panel to keep it visible. Since this is not a Tailwind class, I'm commenting out the code to avoid an ESLint error.\r\n\t\t\t\t */}\r\n\t\t\t\t<span\r\n\t\t\t\t\tref={(el) => (this.hoverBridgeEl = el)}\r\n\t\t\t\t\tclass={`hover-bridge fixed inset-0 ${!(this.hoverBridge && this.active) ? 'hidden' : ''}`}\r\n\t\t\t\t></span>\r\n\t\t\t\t{/* eslint-enable tailwindcss/no-custom-classname */}\r\n\t\t\t\t<div ref={(el) => (this.popup = el)} class={`isolate top-0 left-0 z-40 ${this.strategy} ${displayClass}`}>\r\n\t\t\t\t\t<slot></slot>\r\n\t\t\t\t\t{this.arrow && (\r\n\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\tref={(el) => {\r\n\t\t\t\t\t\t\t\tthis.arrowEl = el;\r\n\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\tclass={`absolute size-2.5 bg-main_text z-[-1] rotate-45 ${displayClass}`}\r\n\t\t\t\t\t\t\trole=\"presentation\"\r\n\t\t\t\t\t\t></div>\r\n\t\t\t\t\t)}\r\n\t\t\t\t</div>\r\n\t\t\t</Host>\r\n\t\t);\r\n\t}\r\n}\r\n"]}